<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Plus+ ‚Äî Assinaturas</title>
<link rel="icon" href="https://i.postimg.cc/fbm60y7Q/logo.png">

<!-- Google Identity Services -->
<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
  :root{--bg:#0f0f10;--card:#111;--accent:#ff0055;--muted:#9a9a9a}
  body{
    margin:0;
    font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;
    background:var(--bg);
    color:#fff;
  }
  .wrap{max-width:980px;margin:28px auto;padding:20px}
  header{display:flex;align-items:center;gap:16px}
  .logo{display:flex;align-items:center;gap:12px}
  .logo img{height:56px;border-radius:8px}
  h1{font-size:20px;margin:0}
  .lead{color:var(--muted);margin-top:6px}
  .main{display:grid;grid-template-columns:360px 1fr;gap:20px;margin-top:20px}
  .card{background:var(--card);padding:18px;border-radius:12px}
  .poster{width:100%;border-radius:8px;display:block}
  .plans{display:flex;flex-direction:column;gap:12px;margin-top:12px}
  .plan{
    padding:12px;
    border-radius:10px;
    background:linear-gradient(180deg,#1a1a1a,#0f0f10);
    border:1px solid rgba(255,255,255,0.03)
  }
  .plan strong{font-size:16px}
  .plan .muted{color:var(--muted)}
  .btn{
    padding:10px 14px;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-weight:700
  }
  .btn-primary{background:var(--accent);color:#fff}
  .btn-ghost{
    background:transparent;
    border:1px solid rgba(255,255,255,0.06);
    color:#fff
  }
  .muted{color:var(--muted);font-size:13px}
  .disabled{opacity:.35;pointer-events:none}
  #afterPayOverlay{
    display:none;position:fixed;inset:0;
    background:rgba(0,0,0,0.85);
    backdrop-filter:blur(4px);
    z-index:99999;
    justify-content:center;align-items:center
  }
  #afterPayBox{
    width:90%;max-width:520px;background:#111;padding:18px;
    border-radius:12px;text-align:center
  }
  @media(max-width:880px){
    .main{grid-template-columns:1fr}
  }
</style>
</head>
<body>

<div class="wrap">

<header>
  <div class="logo">
    <img src="https://i.postimg.cc/fbm60y7Q/logo.png" alt="Plus+">
    <div>
      <h1>Plus+</h1>
      <div class="lead">Assinaturas mensais e anuais ‚Äî fa√ßa login para assinar</div>
    </div>
  </div>

  <!-- Google Button Render -->
  <div style="margin-left:auto" id="gbutton"></div>
</header>

<main class="main">

  <!-- P√îSTER -->
  <div class="card">
    <img class="poster" src="https://i.postimg.cc/yN37MSRy/P-ster-das-assinaturas-Plus.jpg">
    <div class="muted" style="margin-top:10px">
      Fa√ßa login com sua Conta Google. Ap√≥s pagar, abra o app da Plus+ e fa√ßa login com a mesma conta Google.
    </div>
  </div>

  <!-- PLANOS -->
  <div>

    <div class="card">
      <h2 style="margin:0 0 8px 0">Escolha o plano</h2>

      <div class="plans">

        <!-- Mensal -->
        <div class="plan">
          <strong>B√°sico ‚Äî R$9,90/m√™s</strong>
          <div class="muted">Descontos VN ¬∑ 3 canais ¬∑ Conta individual</div>

          <div style="margin-top:10px;display:flex;gap:8px">
            <button id="btnMensal" class="btn btn-primary disabled">Assinar Mensal</button>
            <button class="btn btn-ghost">Detalhes</button>
          </div>
        </div>

        <!-- Anual -->
        <div class="plan">
          <strong>Premium ‚Äî 12x R$10,17 (R$99,90)</strong>
          <div class="muted">At√© 15% de desconto ¬∑ +6 canais ¬∑ Fam√≠lia (2 convidados)</div>

          <div style="margin-top:10px;display:flex;gap:8px">
            <button id="btnAnual" class="btn btn-primary disabled">Assinar Anual</button>
            <button class="btn btn-ghost">Detalhes</button>
          </div>
        </div>

      </div>
    </div>

    <div style="height:12px"></div>

    <!-- STATUS -->
    <div class="card" style="text-align:center">
      <div id="statusArea" class="muted">Voc√™ n√£o est√° logado.</div>
      <div style="height:10px"></div>
      <div style="display:flex;gap:8px;justify-content:center">
        <button id="btnLogin" class="btn btn-ghost">Entrar com Google</button>
        <button id="btnLogout" class="btn" style="display:none">Sair</button>
      </div>
    </div>

  </div>

</main>
</div>

<!-- OVERLAY -->
<div id="afterPayOverlay">
  <div id="afterPayBox">
    <h3>Pagamento iniciado</h3>
    <p>Quando concluir o pagamento, abra o app GL Plus+ e fa√ßa login com a mesma conta Google.</p>
    <button id="afterPayClose" class="btn btn-ghost">Fechar</button>
  </div>
</div>

<!-- LOGIN + LIBERA√á√ÉO PLANOS -->
<script>
/* ==================================
      CONFIGURA√á√ïES REAIS
   ================================== */
const CLIENT_ID = "467099082704-bbqe4ble2u63mbpgv0mkdars78pigi6i.apps.googleusercontent.com";
const LINK_MENSAL = "https://mpago.la/2SRyqam";
const LINK_ANUAL  = "https://mpago.la/2SRyqam";

/* ==================================
      ELEMENTOS
   ================================== */
const btnLogin = document.getElementById('btnLogin');
const btnLogout = document.getElementById('btnLogout');
const btnMensal = document.getElementById('btnMensal');
const btnAnual  = document.getElementById('btnAnual');
const statusArea = document.getElementById('statusArea');
const overlay = document.getElementById('afterPayOverlay');
const overlayClose = document.getElementById('afterPayClose');

/* ==================================
      FUN√á√ïES DO APP ‚Äî IGUAIS!
   ================================== */
function parseJwt (token) {
  try { return JSON.parse(atob(token.split('.')[1])); }
  catch(e) { return null; }
}

function applyLoginState() {
  const saved = localStorage.getItem('glplus_user');

  if (saved) {
    const user = JSON.parse(saved);
    statusArea.textContent = "Logado como " + user.email;

    btnLogin.style.display = "none";
    btnLogout.style.display = "inline-block";

    btnMensal.classList.remove("disabled");
    btnMensal.disabled = false;

    btnAnual.classList.remove("disabled");
    btnAnual.disabled = false;

  } else {
    statusArea.textContent = "Voc√™ n√£o est√° logado.";

    btnLogin.style.display = "inline-block";
    btnLogout.style.display = "none";

    btnMensal.classList.add("disabled");
    btnMensal.disabled = true;

    btnAnual.classList.add("disabled");
    btnAnual.disabled = true;
  }
}

/* ==================================
      CALLBACK DO GOOGLE
   ================================== */
function handleCredentialResponse(res) {
  const payload = parseJwt(res.credential);
  if (!payload) return;

  const user = {
    name: payload.name,
    email: payload.email,
    picture: payload.picture
  };

  // SALVA EXATAMENTE IGUAL AO APP
  localStorage.setItem("glplus_user", JSON.stringify(user));

  applyLoginState();
}

/* ==================================
      INICIALIZA√á√ÉO GOOGLE
   ================================== */
function initGoogle() {
  google.accounts.id.initialize({
    client_id: CLIENT_ID,
    callback: handleCredentialResponse
  });

  google.accounts.id.renderButton(
    document.getElementById('gbutton'),
    { theme:"outline", size:"large" }
  );
}

/* ==================================
      A√á√ïES
   ================================== */
btnLogin.onclick = () => google.accounts.id.prompt();
btnLogout.onclick = () => {
  localStorage.removeItem("glplus_user");
  applyLoginState();
};

btnMensal.onclick = () => {
  window.open(LINK_MENSAL, "_blank");
  overlay.style.display = "flex";
};

btnAnual.onclick = () => {
  window.open(LINK_ANUAL, "_blank");
  overlay.style.display = "flex";
};

overlayClose.onclick = () => overlay.style.display = "none";

/* ==================================
      START
   ================================== */
window.onload = () => {
  applyLoginState();

  let tries = 0;
  const timer = setInterval(() => {
    if (window.google?.accounts?.id) {
      clearInterval(timer);
      initGoogle();
    }
    if (++tries > 20) clearInterval(timer);
  }, 150);
};
</script>

<button id="btnTestPlus" class="btn btn-ghost">
  üß™ Ativar Plus+ (Teste)
</button>

<script>
document.getElementById("btnTestPlus").onclick = () => {
  const saved = localStorage.getItem("glplus_user");

  if (!saved) {
    alert("Fa√ßa login com Google antes de ativar o teste.");
    return;
  }

  const user = JSON.parse(saved);
  const now = Date.now();

  // ASSINATURA GOOGLE (PRINCIPAL)
  localStorage.setItem("plus_google_subscription", JSON.stringify({
    email: user.email,
    plan: "TESTE",
    start: now,
    expiry: now + (30 * 24 * 60 * 60 * 1000), // 30 dias
    type: "google"
  }));

  // TOKEN FAM√çLIA / VISITANTE (OPCIONAL)
  localStorage.setItem("plus_token_access", JSON.stringify({
    token: "GL-TEST-" + Math.random().toString(36).substr(2, 6).toUpperCase(),
    expiry: now + (7 * 24 * 60 * 60 * 1000), // 7 dias
    type: "token"
  }));

  alert("‚úÖ Plus+ TESTE ativado com sucesso!\nAgora abra o app GL Plus+.");

  console.log("Plus+ TESTE ATIVO:", {
    google: JSON.parse(localStorage.getItem("plus_google_subscription")),
    token: JSON.parse(localStorage.getItem("plus_token_access"))
  });
};
</script>
  
</body>
</html>
